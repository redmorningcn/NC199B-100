/*******************************************************************************
 *   Filename:      bsp_ntc.c
 *   Revised:       $Date: 2015-03-11
 *   Revision:      $V1.0
 *   Writer:        Roger-WY.
 *
 *   Description:   NTC温度测量  （25摄氏度时阻值为10K）
 *
 *   Notes:
 *
 *
 *   All copyrights reserved to Roger-WY.
 *
 *******************************************************************************/
#include "bsp_ntc.h"


/***********************************************
* 描述： NTC的温度表
*        该表由NTC厂家提供，购买NTC时需问厂家提供该表
*/
uint16 Tab_R[101] =
{
    32503,30903,29390,27959,26606,25325,24114,22966,21880,20850,
    19875,18950,18074,17242,16453,15705,14994,14320,13679,13071,
    12492,11943,11420,10923,10450,10000,9572,9164,8776,8406,
    8054,7718,7399,7094,6803,6525,6260,6008,5767,5536,
    5316,5106,4906,4714,4531,4355,4188,4028,3874,3728,
    3587,3453,3324,3201,3082,2969,2861,2757,2657,2562,
    2470,2382,2298,2217,2139,2064,1993,1924,1858,1794,
    1733,1675,1618,1564,1512,1462,1414,1367,1323,1280,
    1238,1198,1160,1123,1087,1053,1020,988,957,928,
    900,872,845,819,795,771,748,725,704,683,
    663
};



/*******************************************************************************
 * 名    称： ntctemp
 * 功    能： NTC温度处理，通过查表，做线性。
 * 入口参数： AD测得的NTC的阻值(该电阻值由测得的电压值换算得来)
 * 出口参数： NTC的真实温度值 * 10倍之后的值
 * 作　　者： Snlion_WY
 * 创建日期： 2014-08-20
 * 修    改：
 * 修改日期：
 * 备    注： 注意：测得的温度值是放大10倍之后的值
 *******************************************************************************/
int ntctemp(u32 res)
{
    u16 temp = 0;
    u8 i = 0;

    if((res>Tab_R[0])||(res<Tab_R[100])) {
        return -1;//超量程
    } else {
        while(res<=Tab_R[i]) {
            i++;
        }
        temp = (i-1)*10 + (u16)((((float)(Tab_R[i-1]-res))/((float)(Tab_R[i-1]-Tab_R[i])))*10);
        return temp;//真实温度*10
    }
}



/**********************end of file****************************/